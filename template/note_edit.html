{% extends "base.html" %}
{% block title %}
    {% if mode == 'edit' %}Edit Note{% else %}Create Note{% endif %}
{% endblock %}

{% block content %}
<div class="edit-container">

    <h2 class="edit-title">
        {% if mode == 'edit' %}
            Edit Note
        {% else %}
            Create New Note
        {% endif %}
    </h2>

    <form
        action="{% if mode == 'edit' %}
                    {{ url_for('notes.edit', note_id=note.id) }}
                {% else %}
                    {{ url_for('notes.create') }}
                {% endif %}"
        method="POST"
        class="edit-form"
    >

        <!-- TITLE -->
        <div class="form-group">
            <label for="title">Title</label>
            <input
                type="text"
                id="title"
                name="title"
                placeholder="Enter title"
                value="{{ note.title if mode == 'edit' else '' }}"
            >
        </div>

        <!-- CONTENT -->
        <div class="form-group">
            <label for="content">Content</label>
            <textarea
                id="content"
                name="content"
                rows="8"
                placeholder="Write your note here..."
            >{{ note.content if mode == 'edit' else '' }}</textarea>
        </div>

        <select name="category_id" id="category_id" class="category-select">
            <option value="">No Category</option>
            {% for c in categories %}
                <option 
                    value="{{ c.id }}"
                    {% if mode == 'edit' and note.category_id == c.id %}
                        selected
                    {% endif %}
                >
                    {{ c.name }}
                </option>
            {% endfor %}
        </select>
        <!-- Quick Create Category Button -->
        <button 
            type="button" 
            class="btn-small" 
            id="quick-add-category-btn"
        >
            + Add Category
        </button>


        <!-- REMINDER -->
        <div class="form-group">
            <label for="reminder">Reminder</label>
            <input
                type="datetime-local"
                id="reminder"
                name="reminder"
                value="{% if mode == 'edit' and note.reminder %}{{ note.reminder }}{% endif %}"
            >
        </div>

        <!-- PIN NOTE -->
        <div class="form-group check-row">
            <input
                type="checkbox"
                id="pinned"
                name="pinned"
                {% if mode == 'edit' and note.pinned %}checked{% endif %}
            >
            <label for="pinned">Pin this note</label>
        </div>
        {% if mode == 'edit' %}
            <a 
                class="btn-secondary"
                href="{{ url_for('notes.download_note', note_id=note.id) }}"
            >
                Download Note
            </a>
        {% endif %}

        <!-- ACTION BUTTON -->
        <button type="submit" class="btn-primary">
            {% if mode == 'edit' %}Update Note{% else %}Create Note{% endif %}
        </button>

        <!-- CANCEL -->
        <a href="{{ url_for('notes.dashboard') }}" class="btn-secondary">
            Cancel
        </a>

    </form>

</div>
{% endblock %}
